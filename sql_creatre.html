<strong>変換前データ</strong>
&#65279;


<textarea id="txtInput" rows="10"></textarea>

<input type="button" value="INSERT文を生成" onclick="func()"><br>

<strong><font color="green">変換後データ</font></strong>
<textarea id="StrTitle" rows="10" style="background-color:#DDFFDD" onclick="this.focus(); this.select()"></textarea>

<br>



	<script>
	function func() {
		var strInputData = document.getElementById('txtInput').value;	//入力データ		
		var strSeparator = '\n';										//改行
		var arrString1 = strInputData.split(strSeparator);				//改行でスプリット
		var lngCnt = arrString1.length;									//改行の数
		var strHeader = '';												//固定部分の書き出しデータ
		var strFooter = '';												//可変部分の書き出しデータ						
		
		//改行のぶんループ
		for (var i = 0; i < lngCnt; i++) {
		
			//1行目はテーブル名
			if(i == 0){				
				strHeader = 'INSERT INTO ' + arrString1[0] + '(';
			}
			
			//2行目は列名
			if(i == 1){
				var strSeparator = ',';
				var arrString2 = arrString1[1].split(strSeparator);			
			
				arrString2.forEach(function(strSplitData2){
					strHeader +=  strSplitData2 + ',';
				});	
				
				strHeader = strHeader.substr(0,	strHeader.length -1);	//一番後ろのカンマを取る
				strHeader = strHeader + ') ';														
			}			
			
			//3行目以降はデータ
			if(i > 1){						
				
				
				var strSeparator = ',';
				var arrString2 = arrString1[i].split(strSeparator);		
				
				//データがない場合は生成しない	
				if(arrString2 != ''){		
				
					strFooter += strHeader + 'VALUES(';
			
					arrString2.forEach(function(strSplitData2){
					strFooter +=  '\'' + strSplitData2 + '\',';
					});		
					
					strFooter = strFooter.substr(0,	strFooter.length -1);	//一番後ろのカンマを取る				
					strFooter += ')' + '\n' ;		
				}	
			}			
		}
		
		if(!strFooter){
			strFooter =	'テーブル名、列名またはインサートデータがありません。'	
		}
		
		
		//処理結果をテキストボックスに書き出す
		document.getElementById('StrTitle').value = strFooter;			
	}
	</script>



<p>データは以下のルールで入力してください。<br>
<span style="color: blue;"><br>
1行目「テーブル名」<br>
2行目「列名」<br>
3行目以降「インサートするデータ」<br>
</span></p>
<p>※「列名」「インサートするデータ」はカンマ区切りで複数指定できます。</p>